# TASKS.md — Квиз MVP (React, Lovable)

## Описание проекта
Простой MVP квиза на React (Lovable). Вся визуальная часть уже реализована. Основная задача — реализовать **логику ветвления и сохранение результата в JSON (localStorage)**. Бэкенд, CI/CD, тесты и сложный DevOps пока не нужны.

---

## Legend
- [ ] — задача не начата
- [x] — задача выполнена

---

## Definition of Done
- Все вопросы и ветвления из PDF реализованы.
- Пользователь может проходить квиз, переходить вперёд и назад.
- Ветвления корректно работают (например, разделы B2B/B2C).
- По завершении формируется JSON в `localStorage`.
- JSON содержит путь прохождения (вопрос → ответ).
- Интерфейс остаётся в рамках существующего дизайна Lovable.

---

## Milestone 0 — Scaffolding & Setup
- [x] **Подготовка проекта**  
  **Goal:** создать инфраструктуру для логики квиза.  
  **Scope:** `/src/quiz/`  
  **Acceptance Criteria:** есть директория для логики и данных.  
  **Validation:** ручная проверка структуры.  

- [x] **Импорт и структура вопросов**  
  **Goal:** перевести PDF в JSON-структуру дерева квиза.  
  **Scope:** `/src/quiz/questions.ts`  
  **Acceptance Criteria:** JSON отражает разделы A–G (с вопросами и вариантами).  
  **Validation:** сверка с PDF.  

---

## Milestone 1 — Логика навигации
- [x] **Рендеринг раздела A (Профиль компании)**  
  **Goal:** добавить вопросы отрасли, бизнес-модели, географии, роста/возврата клиентов, оборота, сотрудников, роли ЛПР, требований к данным.  
  **Scope:** `/src/quiz/questions.ts` (реализовано в структуре данных)  
  **Acceptance Criteria:** все вопросы раздела A отображаются и записываются в JSON.  
  **Validation:** пройти раздел и проверить localStorage.

- [x] **Рендеринг раздела B (Коммерция и воронка)**  
  **Goal:** реализовать вопросы про лиды, источники, длительность сделки, чек/LTV, CRM, команду, узкое место, автоматизацию.  
  **Scope:** `/src/quiz/questions.ts` (реализовано в структуре данных)  
  **Acceptance Criteria:** корректный показ и запись ответов.  
  **Validation:** прохождение с выбором B2B и B2C.

- [x] **Ветвления B2B/B2C**  
  **Goal:** добавить условные вопросы для B2B (длительность сделки, ЛПР, исходящий поиск) и B2C (каналы, удержание, поддержка).  
  **Scope:** `/src/quiz/QuizEngine.tsx` + `/src/quiz/questions.ts`  
  **Acceptance Criteria:** при выборе модели показываются только релевантные вопросы.  
  **Validation:** сценарное прохождение.

- [x] **Рендеринг раздела C (Операции и процессы)**  
  **Goal:** добавить вопросы о процессах, объёмах и метриках.  
  **Scope:** `/src/quiz/questions.ts` (реализовано в структуре данных)  
  **Acceptance Criteria:** ответы записываются в JSON.  
  **Validation:** ручное тестирование.

- [x] **Рендеринг раздела D (Стек и зрелость ИИ)**  
  **Goal:** реализовать вопросы о системах, заборе данных, используемых ИИ-инструментах и хранении данных.  
  **Scope:** `/src/quiz/questions.ts` (реализовано в структуре данных)  
  **Acceptance Criteria:** все вопросы раздела D доступны.  
  **Validation:** ручное тестирование.

- [x] **Рендеринг раздела E (Приоритеты и пилот)**  
  **Goal:** добавить вопросы о приоритетах и готовности к пилоту.  
  **Scope:** `/src/quiz/questions.ts` (реализовано в структуре данных)  
  **Acceptance Criteria:** раздел всегда отображается.  
  **Validation:** прохождение раздела.

- [x] **Навигация назад/вперёд**  
  **Goal:** реализовать кнопки и корректный пересчёт пути.  
  **Scope:** `/src/quiz/QuizEngine.tsx`  
  **Acceptance Criteria:** можно двигаться по квизу в обе стороны.  
  **Validation:** ручное тестирование.

---

## Milestone 2 — Сохранение и результат
- [x] **Формирование JSON**  
  **Goal:** собирать массив `{questionId, answerId}` по мере ответов.  
  **Scope:** `/src/quiz/store.ts`  
  **Acceptance Criteria:** JSON формируется корректно.  
  **Validation:** вывод в консоль.

- [x] **Сохранение в localStorage**  
  **Goal:** записывать результат после завершения.  
  **Scope:** `/src/quiz/store.ts`  
  **Acceptance Criteria:** есть запись `quizResult`.  
  **Validation:** проверка в DevTools.

- [x] **Экран завершения**  
  **Goal:** отобразить сообщение о завершении + кнопку «Начать заново».  
  **Scope:** `/src/components/QuizComplete.tsx`  
  **Acceptance Criteria:** после прохождения квиза показывается финальный экран.  
  **Validation:** ручное тестирование.

---

## Milestone 3 — Дополнительные разделы
- [x] **Условный Раздел F (юридическое и риски)**  
  **Goal:** показывать только если выбраны чувствительные данные в Разделе A.  
  **Scope:** `/src/quiz/questions.ts` (реализовано через условие показа секции)  
  **Acceptance Criteria:** корректный показ по условию.  
  **Validation:** сценарное тестирование.

- [x] **Форма контактов (Раздел G)**  
  **Goal:** добавить сбор контактов и согласий (имя, email, чекбокс).  
  **Scope:** `/src/quiz/questions.ts` (реализовано в структуре данных)  
  **Acceptance Criteria:** форма обязательна для завершения.  
  **Validation:** ручное тестирование.

---

## Milestone 4 — Улучшения UX и экспорт данных
- [x] **Валидация полей email и телефон**  
  **Goal:** добавить валидацию полей email и телефон с показом ошибок при неправильном вводе.  
  **Scope:** `/src/components/QuizQuestion.tsx`  
  **Acceptance Criteria:** поля email и телефон валидируются в реальном времени, ошибки отображаются пользователю, переход к следующему шагу блокируется при некорректных данных.  
  **Validation:** ручное тестирование с некорректными и корректными данными.

- [x] **Кнопка скачивания JSON результата**  
  **Goal:** добавить на экран завершения кнопку для скачивания JSON файла со всеми ответами.  
  **Scope:** `/src/components/QuizComplete.tsx`, `/src/quiz/store.ts`  
  **Acceptance Criteria:** после завершения квиза пользователь может скачать JSON файл с полной структурой ответов, файл имеет читаемое имя с датой/временем.  
  **Validation:** ручное тестирование скачивания и проверка содержимого файла.

- [x] **Маскирование и форматирование телефона**  
  **Goal:** добавить маску для поля телефона с автоформатированием (+7 по умолчанию, красивое отображение).  
  **Scope:** `/src/components/QuizQuestion.tsx`  
  **Acceptance Criteria:** поле телефона всегда начинается с +, по умолчанию +7, при вводе применяется красивое форматирование, можно менять код страны.  
  **Validation:** ручное тестирование ввода различных номеров.

---

## Milestone 5 — Поддержка Telegram Mini Apps
- [x] **Базовая поддержка Telegram WebApp API**  
  **Goal:** добавить минимальную поддержку Telegram Mini Apps - определение среды и базовые функции WebApp API.  
  **Scope:** новый хук useTelegram, обновление App.tsx для определения Telegram среды  
  **Acceptance Criteria:** приложение определяет, что запущено в Telegram, инициализирует WebApp API, квиз работает в Telegram Mini App.  
  **Validation:** тестирование в Telegram Bot с Mini App, проверка базовой функциональности квиза.  
  **Notes/Links:** Минимальная реализация - только определение среды и базовая инициализация.

- [ ] **Адаптация UI для мобильного Telegram**  
  **Goal:** оптимизировать интерфейс для мобильного использования в Telegram (размеры кнопок, отступы).  
  **Scope:** обновление стилей в компонентах QuizQuestion, QuizComplete  
  **Acceptance Criteria:** UI удобен для использования на мобильных устройствах в Telegram, кнопки достаточно большие для тапа.  
  **Validation:** тестирование в Telegram Mini App на мобильном устройстве.  
  **Notes/Links:** Фокус на мобильную оптимизацию, без сложных изменений дизайна.  

## TEMPLATE для новых задач
- [ ] **Название задачи**  
  **Goal:** краткое описание цели.  
  **Scope:** где менять код.  
  **Acceptance Criteria:** список критериев.  
  **Validation:** ручное / автотест.  
  **Notes/Links:** дополнительные ссылки или материалы.

